version: '3'

services:
    yvideo:
        depends_on:
         - lamp
         - database
        build:
            context: production
            args:
                sbt_version: 0.13.8
            dockerfile: Dockerfile
        image: yvideo_prod
        ports:
         - "9001:9000"

        command: bash -c "sbt clean stage && target/universal/stage/bin/ayamelexamples"

    lamp:
        build: lamp
        image: lamp_prod
        ports:
         - "80:80"

    database:
        image: yvideodb_prod
